---
title: "Titanic EDA"
output: html_notebook
---

To get a sense for the Titanic data set, we are going to do some exploratory 
data analysis. As part of that, we will use the `xray` package to check 
for anomalies and look at distributions.

```{r setup, message = FALSE}
library(tidyverse)
library(xray)
```

## Data Import

First, we need to import the training and testing data.

```{r, message = FALSE}
training <- read_csv("train.csv", progress = FALSE)
testing <- read_csv("test.csv", progress = FALSE)
```

Now, let's take a look at the data.

```{r}
training
```

We can also use `glimpse` to take a look at the variables. 

```{r}
glimpse(training)
```

We have 12 variables that we will want to look at. According to the data set 
description from Kaggle, the variables are defined in the following way: 

* PassengerId -- A numerical id for each passenger.
* Survived -- The response variable as a factor showing survival.
* Pclass -- The ticket class of the passenger used as a proxy for socio-economic 
class. This variable is a factor with levels 1 = 1st (Upper Class), 
2 = 2nd (Middle Class), and 3 = 3rd (Lower Class).
* Name -- The full name of the passenger with title. Married female passengers 
appear to have their partner's name listed with their actual name in 
parentheses.
* Sex -- A factor showing the sex of the passenger.
* Age -- The age of the passenger. Estimated ages are given as xx.#. 
* SibSp -- The number of siblings and spouses the passnger has aboard. 
* Parch -- The number of parent/children relationships that the passneger has 
aboard.
* Ticket -- Ticket number of the passenger.
* Fare -- The passenger fare. 
* Cabin -- The passenge cabin number. 
* Embarked -- The port of embarkation. This is a factor with three levels 
C = Cherbourg, Q = Queenstown, S = Southampton.

Before we begin the exploration, let's recode the factors with proper levels. 

```{r}
training <- training %>% 
  mutate(Survived = factor(Survived, 
                           levels = c(1, 0), 
                           labels = c("Yes", "No"))) %>% 
  mutate(Pclass = factor(Pclass, 
                         levels = c(3, 2, 1), 
                         labels = c("3rd", "2nd", "1st"), 
                         ordered = TRUE)) %>% 
  mutate(Sex = factor(Sex, 
                      levels = c("male", "female"))) %>% 
  mutate(Embarked = factor(Embarked, 
                           levels = c("C", "Q", "S"), 
                           labels = c("Cherbourg", "Queenstown", "Southampton")))
```

```{r}
testing <- testing %>% 
  mutate(Pclass = factor(Pclass, 
                         levels = c(3, 2, 1), 
                         labels = c("3rd", "2nd", "1st"), 
                         ordered = TRUE)) %>% 
  mutate(Sex = factor(Sex, 
                      levels = c("male", "female"))) %>% 
  mutate(Embarked = factor(Embarked, 
                           levels = c("C", "Q", "S"), 
                           labels = c("Cherbourg", "Queenstown", "Southampton")))
```

## Checking Anomalies with `xray`

Now that the data sets have been re-coded with factors, let's take a look for 
any anomalies in the data set using the `xray` package.

```{r xray_anomalies, results = 'asis'}
xray::anomalies(training)$variables %>% 
  knitr::kable()
```

